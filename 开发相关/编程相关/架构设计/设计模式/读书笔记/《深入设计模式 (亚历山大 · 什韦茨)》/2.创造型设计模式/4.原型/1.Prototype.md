>原型是一种创建型设计模式，使你能够复制已有对象，而又无需使代码依赖它们所属的类。

# 结构

![[Pasted image 20220830151715.png]]

1. 原型（Prototype）接口将对克隆方法进行声明。在绝大多数情况下，其中只会有一个名为 clone 克隆的方法。
2. 具体原型（Concrete Prototype）类将实现克隆方法。除了将原始对象的数据复制到克隆体中之外，该方法有时还需处理克隆过程中的极端情况，例如克隆关联对象和梳理递归依赖等等。
3. 客户端（Client）可以复制实现了原型接口的任何对象。

# 原型注册表实现

![[Pasted image 20220830153211.png]]

1. 原型注册表（Prototype Registry）提供了一种访问常用原型的简单方法，其中存储了一系列可供随时复制的预生成对象。最简单的注册表原型是一个名称 → 原型的哈希表。但如果需要使用名称以外的条件进行搜索，你可以创建更加完善的注册表版本。

# 实现方式

1. 创建原型接口，并在其中声明克隆方法。如果你已有类层次结构，则只需在其所有类中添加该方法即可。
2. 原型类必须另行定义一个以该类对象为参数的构造函数。构造函数必须复制参数对象中的所有成员变量值到新建实体中。如果你需要修改子类，则必须调用父类构造函数，让父类复制其私有成员变量值。
3. 克隆方法通常只有一行代码：使用 new 运算符调用原型版本的构造函数。注意，每个类都必须显式重写克隆方法并使用自身类名调用 new 运算符。否则，克隆方法可能会生成父类的对象。
4. 你还可以创建一个中心化原型注册表，用于存储常用原型。

