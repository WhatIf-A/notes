# 什么是服务雪崩？
下游服务拖垮上游服务导致整个集群变为不可用状态。
# Sentinel 服务容错的思路
内部的异常治理，外部用户流量的疏导。
## 内部异常治理
在 Sentinel 中，我们可以采用降级和熔断的方式处理内部的异常。
### 降级
所谓降级，是指当服务调用发生了响应超时、服务异常等情况时，我们在服务内部可以执行一段“降级逻辑”。
![[Pasted image 20220810002806.png]]
降级是针对“单次服务调用异常”而执行的处理逻辑。
### 熔断
所谓熔断，是指当异常调用量达到一定的判定条件，比如在异常降级和慢调用请求的比例达到一个阈值、窗口时间内降级请求达到一定数量的情况下，微服务在一段时间内停止对目标服务发起调用，所有来访请求直接执行降级逻辑。
![[Pasted image 20220810003159.png]]
所以，熔断是“多次服务调用异 常”累积的结果。
## 外部流量控制
### 快速失败
一旦访问量超过阈值，后续的请求就会被“fast fail”。
### 预热模型
在一段规定的预热时间窗口内，由低到高逐渐拉高流量阈值，直到达到预设的最高阈值为止。
### 排队模型
如果访问量超过了设定的阈值，服务请求不会被立即失败，而是被放入一个队列内等待处理，如果服务请求在预设的超时时间内仍然未被处理，那么就会被移出队列。
